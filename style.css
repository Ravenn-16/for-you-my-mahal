:root{
  --bg1:#2a0712;
  --bg2:#4b0b1e;
  --bg3:#6f1732;
  --paper:#f2e6cf;
  --paper2:#ead9b8;
  --ink:#3c1b1b;
  --wine:#6b0f25;
  --wine2:#8c1835;
  --glow-rose: rgba(220, 120, 142, .22);
  --glow-gold: rgba(239, 194, 129, .18);
  --shadow: 0 18px 50px rgba(0,0,0,.35);
  --radius: 18px;
}

*{ box-sizing:border-box; }
html,body{ height:100%; }

body{
  position: relative;
  margin:0;
  min-height:100vh;
  font-family:"Cinzel", serif;
  color: var(--ink);
  overflow:hidden;
  background:
    radial-gradient(1300px 820px at 8% -8%, rgba(255,255,255,.13), transparent 55%),
    radial-gradient(980px 640px at 88% 4%, var(--glow-rose), transparent 65%),
    radial-gradient(1000px 700px at 50% 100%, rgba(0,0,0,.30), transparent 62%),
    linear-gradient(145deg, #1d0410 0%, var(--bg1) 28%, var(--bg2) 66%, var(--bg3) 100%);
}

body::before,
body::after{
  content:"";
  position: fixed;
  border-radius: 999px;
  pointer-events:none;
  filter: blur(8px);
  z-index:0;
}

body::before{
  width:min(48vw, 520px);
  height:min(48vw, 520px);
  top:-16vh;
  left:-10vw;
  background: radial-gradient(circle at 35% 35%, var(--glow-gold) 0%, rgba(239,194,129,0) 68%);
  animation: bgFloatA 14s ease-in-out infinite alternate;
}

body::after{
  width:min(40vw, 460px);
  height:min(40vw, 460px);
  right:-8vw;
  bottom:-14vh;
  background: radial-gradient(circle at 50% 50%, var(--glow-rose) 0%, rgba(220,120,142,0) 70%);
  animation: bgFloatB 16s ease-in-out infinite alternate;
}

.stage{
  position:relative;
  z-index:1;
  height:100%;
  display:grid;
  place-items:center;
  padding:24px;
}

@keyframes bgFloatA{
  from{ transform: translate3d(0, 0, 0) scale(1); }
  to{ transform: translate3d(2vw, 3vh, 0) scale(1.08); }
}

@keyframes bgFloatB{
  from{ transform: translate3d(0, 0, 0) scale(1); }
  to{ transform: translate3d(-2vw, -2vh, 0) scale(1.06); }
}

.step{
  position:absolute;
  inset:0;
  display:grid;
  place-items:center;
  opacity:0;
  pointer-events:none;
  transform: scale(.98);
  transition: opacity .35s ease, transform .35s ease;
}
.step--active{
  opacity:1;
  pointer-events:auto;
  transform: scale(1);
}

/* Envelope */
.envelope-wrap{ display:grid; place-items:center; gap:14px; }

.envelope{
  width:min(680px, 92vw);
  aspect-ratio: 16/9;
  position:relative;
  filter: drop-shadow(0 30px 40px rgba(0,0,0,.35));
}

.env-back{
  position:absolute; inset:0;
  border-radius: 26px;
  background:
    radial-gradient(700px 350px at 70% 15%, rgba(255,255,255,.10), transparent 55%),
    linear-gradient(135deg, #3d0716, #6c0d28);
}

.env-left, .env-right, .env-bottom, .env-flap{
  position:absolute; inset:0; border-radius: 26px;
}

.env-bottom{
  clip-path: polygon(0 100%, 50% 55%, 100% 100%);
  background: linear-gradient(135deg, #2b0611, #5c0c23);
  opacity:.9;
}

.env-left{
  clip-path: polygon(0 0, 50% 55%, 0 100%);
  background: linear-gradient(135deg, #2b0611, #6d0f2a);
  opacity:.95;
}

.env-right{
  clip-path: polygon(100% 0, 50% 55%, 100% 100%);
  background: linear-gradient(225deg, #2b0611, #6d0f2a);
  opacity:.95;
}

.env-flap{
  clip-path: polygon(0 0, 50% 55%, 100% 0);
  background: linear-gradient(135deg, #7c1231, #3b0615);
  transform-origin: top center;
  transition: transform .8s cubic-bezier(.2,.8,.2,1);
  border-top-left-radius: 26px;
  border-top-right-radius: 26px;
}

.env-letter{
  position:absolute;
  left:50%; top:55%;
  transform: translate(-50%, -50%);
  width:72%; height:70%;
  border-radius:18px;
  background:
    linear-gradient(180deg, rgba(0,0,0,.07), transparent 30%),
    radial-gradient(900px 300px at 20% 25%, rgba(255,255,255,.16), transparent 60%),
    linear-gradient(135deg, var(--paper), var(--paper2));
  box-shadow: inset 0 0 0 1px rgba(60,27,27,.12);
  transition: transform .8s cubic-bezier(.2,.8,.2,1);
}

.mini-card{ height:100%; display:grid; place-items:center; gap:6px; text-align:center; }
.mini-title{ font-weight:700; letter-spacing:.08em; font-size:18px; }
.mini-sub{ font-family:"Great Vibes", cursive; font-size:24px; opacity:.9; }

.seal{
  position:absolute;
  left:50%; top:55%;
  transform: translate(-50%, -50%);
  width:74px; height:74px;
  border-radius:999px;
  border:none;
  background: radial-gradient(circle at 30% 25%, #ffb1c2, #8d1435 60%, #5e0d22 100%);
  box-shadow: 0 18px 30px rgba(0,0,0,.35), inset 0 0 0 2px rgba(255,255,255,.18);
  cursor:pointer;
}
.seal-heart{ font-size:30px; color: rgba(255,255,255,.92); }
.hint{ color: rgba(255,255,255,.85); font-family:"Great Vibes", cursive; font-size:28px; }

.envelope.open .env-flap{ transform: rotateX(155deg); }
.envelope.open .env-letter{ transform: translate(-50%, -70%) scale(1.03); }

/* Base card */
.card{
  width:min(760px, 94vw);
  background:
    radial-gradient(900px 420px at 20% 20%, rgba(255,255,255,.24), transparent 60%),
    linear-gradient(135deg, var(--paper), var(--paper2));
  border-radius: var(--radius);
  padding: clamp(20px, 3.2vw, 34px) clamp(16px, 2.8vw, 26px);
  box-shadow: var(--shadow);
  text-align:center;
  position:relative;
}

.lace{
  border: 18px solid transparent;
  border-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='220' height='220' viewBox='0 0 220 220'%3E%3Crect x='16' y='16' width='188' height='188' rx='22' ry='22' fill='%23f7f0e7' stroke='%23d9cbb7' stroke-width='6'/%3E%3C/svg%3E") 40 / 18px / 10px round;
}

.ribbon{
  position:absolute;
  top:16px; left:18px;
  width:64px; height:64px;
  border-radius:14px;
  background: linear-gradient(135deg, rgba(141,20,53,.15), rgba(141,20,53,.05));
}

.card-title{
  margin:0;
  font-size: clamp(16px, 2.2vw, 22px);
  letter-spacing: .14em;
  font-weight: 700;
}

.card-script{
  margin: 8px 0 18px;
  font-family:"Great Vibes", cursive;
  font-size: clamp(40px, 7vw, 64px);
  font-weight: 400;
  color:#6b0f25;
}
.card-script.small{ font-size: clamp(34px, 6.2vw, 54px); }

.btn-row{
  display:flex;
  justify-content:center;
  gap:14px;
  margin-top: 14px;
  position:relative;
}

.btn{
  border:none;
  padding: 11px 22px;
  font-weight:700;
  letter-spacing:.12em;
  border-radius: 10px;
  cursor:pointer;
  box-shadow: 0 12px 20px rgba(0,0,0,.18);
  min-height: 46px;
}

.btn-yes{
  background: linear-gradient(135deg, var(--wine), var(--wine2));
  color: rgba(255,255,255,.95);
}
.btn-no{
  background: #2b0611;
  color: rgba(255,255,255,.92);
}

.card-footer{
  margin-top: 16px;
  opacity:.75;
  font-size: 12px;
  letter-spacing:.10em;
}

.cute-row{
  display:flex;
  align-items:center;
  justify-content:center;
  gap:14px;
  margin: 10px 0 6px;
}

.doodle{
  font-family:"Great Vibes", cursive;
  font-size: 44px;
  color:#6b0f25;
  opacity:.85;
}

.cute-note{
  font-weight:700;
  letter-spacing:.08em;
  opacity:.85;
}

.nav-row{
  margin-top: 14px;
  display:flex;
  justify-content:center;
  gap: 10px;
  flex-wrap: wrap;
}

.btn-next{
  min-width: 110px;
  background: rgba(107,15,37,.12);
  color: #4a1119;
  box-shadow:none;
  border: 1px solid rgba(60,27,27,.18);
}

.btn-back{
  background: rgba(43,6,17,.08);
}

/* Moments (screenshot style) */
.moments-container{
  width:min(980px, 96vw);
  padding: 48px 36px;
  background: linear-gradient(135deg, #f6e8cc, #efe0c2);
  border-radius: 26px;
  box-shadow: 0 30px 60px rgba(0,0,0,.35);
  text-align:center;
}

.moments-title{
  margin:0;
  letter-spacing: .20em;
  font-size: 16px;
}

.moments-years{
  margin: 10px 0 24px;
  font-family:"Great Vibes", cursive;
  font-size: 52px;
  color:#7a1c2f;
}

.moments-box{
  display:grid;
  grid-template-columns: 70px 1fr 70px;
  align-items:center;
  gap: 16px;
}

.nav-btn{
  width: 56px;
  height: 56px;
  border-radius: 14px;
  border: 1px solid rgba(60,27,27,.20);
  background: rgba(120,40,60,.12);
  font-size: 34px;
  cursor:pointer;
}

.moment-card{
  background: rgba(234,219,189,.9);
  padding: 26px 24px;
  border-radius: 22px;
  box-shadow: inset 0 0 0 2px rgba(120,40,60,.12);
}

.moment-year{
  font-weight:700;
  letter-spacing:.18em;
  margin-bottom: 14px;
}

.moment-image-box{
  width:100%;
  height: clamp(300px, 54vh, 560px);
  background: #ddd;
  border-radius: 16px;
  overflow:hidden;
  position: relative;
}

/* image */
.moment-image-box img{
  width:100%;
  height:100%;
  object-fit:cover;
  display:block;
}

/* video */
.moment-image-box video{
  width:100%;
  height:100%;
  object-fit:cover;
  display:none;
}

.moment-caption{
  margin: 12px 4px 0;
  min-height: 24px;
  font-family: "Great Vibes", cursive;
  font-size: 32px;
  color:#6f1a2d;
  text-align:center;
  line-height: 1.1;
}

.moment-dots{
  display:flex;
  justify-content:center;
  gap:8px;
  margin-top: 14px;
}

.moment-dots span{
  width:10px;
  height:10px;
  border-radius:999px;
  background: #b28a8a;
  opacity: .4;
}

.moment-dots .active{
  opacity: 1;
  background: #7a1c2f;
}

/* Letter */
.message-card{
  text-align:left;
  padding: 28px 24px 22px;
  width:min(860px, 94vw);
  max-height:min(86vh, 840px);
  display:flex;
  flex-direction:column;
  gap:14px;
  background:
    radial-gradient(1100px 440px at 12% -10%, rgba(255,255,255,.48), transparent 52%),
    radial-gradient(700px 360px at 100% 100%, rgba(163,72,72,.09), transparent 62%),
    linear-gradient(135deg, #f8edd6 0%, #f1dfc2 100%);
  box-shadow:
    0 26px 52px rgba(0,0,0,.34),
    inset 0 0 0 1px rgba(81,39,30,.10);
}

.message-scroll{
  position:relative;
  flex:1;
  overflow-y:auto;
  border-radius:14px;
  padding: 18px 18px 10px;
  background:
    linear-gradient(to bottom, rgba(146,67,55,.16) 0 2px, transparent 2px 100%),
    repeating-linear-gradient(
      to bottom,
      rgba(94,42,42,.09) 0,
      rgba(94,42,42,.09) 1px,
      transparent 1px,
      transparent 35px
    ),
    linear-gradient(180deg, #fcf4e4 0%, #f4e4ca 100%);
  box-shadow:
    inset 0 0 0 1px rgba(86,42,33,.12),
    inset 0 18px 24px rgba(255,255,255,.22);
}

.message-scroll::after{
  content:"";
  position:sticky;
  display:block;
  left:0;
  right:0;
  bottom:0;
  height:38px;
  margin-top:-38px;
  pointer-events:none;
  background: linear-gradient(to bottom, rgba(244,228,202,0), #f4e4ca 78%);
}

.message-scroll::-webkit-scrollbar{
  width: 10px;
}

.message-scroll::-webkit-scrollbar-track{
  background: rgba(84,33,28,.10);
  border-radius: 999px;
}

.message-scroll::-webkit-scrollbar-thumb{
  background: linear-gradient(180deg, #9f4a4a, #763334);
  border-radius: 999px;
}

.message-scroll{
  scrollbar-width: thin;
  scrollbar-color: #8f4344 rgba(84,33,28,.12);
}

.message{
  margin: 12px 0;
  font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
  font-size: 17px;
  line-height: 1.9;
  color:#452726;
  text-shadow: 0 1px 0 rgba(255,255,255,.22);
}
.message.sign{
  font-family:"Great Vibes", cursive;
  font-size: 34px;
  margin-top: 10px;
  color:#6b0f25;
}

@media (max-width: 1024px){
  .moments-container{
    width:min(920px, 96vw);
    padding: 32px 20px;
  }
  .moment-image-box{
    height: clamp(260px, 48vh, 460px);
  }
}

@media (max-width: 560px){
  .envelope{
    width:min(94vw, 540px);
  }
  .seal{
    width:64px;
    height:64px;
  }
  .seal-heart{
    font-size:26px;
  }
  .hint{
    font-size:24px;
  }
  .btn-row{
    flex-wrap: wrap;
  }
  .btn{
    width:100%;
  }
  .moments-box{ grid-template-columns: 56px 1fr 56px; gap: 10px; }
  .nav-btn{ width:46px; height:46px; font-size: 28px; }
  .moments-years{ font-size: 44px; }
  .moment-card{ padding: 16px 12px; }
  .moment-image-box{ height: clamp(220px, 42vh, 340px); }
  .moment-caption{ font-size: 26px; }
  .message-card{
    padding: 22px 16px 14px;
    max-height: 92vh;
  }
  .message-scroll{
    padding: 14px 12px 8px;
  }
  .message{
    font-size: 15px;
    line-height: 1.75;
  }
  .message.sign{
    font-size: 30px;
  }
}

@media (max-width: 880px){
  body{ overflow:auto; }
  .stage{
    min-height:100dvh;
    height:auto;
    padding:14px;
  }
  .step{
    position:relative;
    inset:auto;
    min-height:calc(100dvh - 28px);
    display:none;
    opacity:1;
    transform:none;
    transition:none;
  }
  .step--active{
    display:grid;
  }
  .moment-caption{
    font-size: clamp(22px, 6vw, 30px);
  }
}

@media (min-width: 561px) and (max-width: 880px){
  .moments-box{
    grid-template-columns: 54px 1fr 54px;
    gap: 8px;
  }
}
